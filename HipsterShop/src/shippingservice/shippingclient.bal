import ballerina/grpc;
import ballerinaDemo/cartservice;
import ballerinaDemo/currencyservice;

public type ShippingServiceBlockingClient client object {

    *grpc:AbstractClientEndpoint;

    private grpc:Client grpcClient;

    public function __init(string url, grpc:ClientConfiguration? config = ()) {
        // initialize client endpoint.
        grpc:Client c = new(url, config);
        grpc:Error? result = c.initStub(self, "blocking", ROOT_DESCRIPTOR, getDescriptorMap());
        if (result is grpc:Error) {
            error err = result;
            panic err;
        } else {
            self.grpcClient = c;
        }
    }

    public remote function GetQuote(GetQuoteRequest req, grpc:Headers? headers = ()) returns ([GetQuoteResponse, grpc:Headers]|grpc:Error) {
        
        var payload = check self.grpcClient->blockingExecute("hipstershop.ShippingService/GetQuote", req, headers);
        grpc:Headers resHeaders = new;
        anydata result = ();
        [result, resHeaders] = payload;
        var value = typedesc<GetQuoteResponse>.constructFrom(result);
        if (value is GetQuoteResponse) {
            return [value, resHeaders];
        } else {
            return grpc:prepareError(grpc:INTERNAL_ERROR, "Error while constructing the message", value);
        }
    }

    public remote function ShipOrder(ShipOrderRequest req, grpc:Headers? headers = ()) returns ([ShipOrderResponse, grpc:Headers]|grpc:Error) {
        
        var payload = check self.grpcClient->blockingExecute("hipstershop.ShippingService/ShipOrder", req, headers);
        grpc:Headers resHeaders = new;
        anydata result = ();
        [result, resHeaders] = payload;
        var value = typedesc<ShipOrderResponse>.constructFrom(result);
        if (value is ShipOrderResponse) {
            return [value, resHeaders];
        } else {
            return grpc:prepareError(grpc:INTERNAL_ERROR, "Error while constructing the message", value);
        }
    }

};

public type ShippingServiceClient client object {

    *grpc:AbstractClientEndpoint;

    private grpc:Client grpcClient;

    public function __init(string url, grpc:ClientConfiguration? config = ()) {
        // initialize client endpoint.
        grpc:Client c = new(url, config);
        grpc:Error? result = c.initStub(self, "non-blocking", ROOT_DESCRIPTOR, getDescriptorMap());
        if (result is grpc:Error) {
            error err = result;
            panic err;
        } else {
            self.grpcClient = c;
        }
    }

    public remote function GetQuote(GetQuoteRequest req, service msgListener, grpc:Headers? headers = ()) returns (grpc:Error?) {
        
        return self.grpcClient->nonBlockingExecute("hipstershop.ShippingService/GetQuote", req, msgListener, headers);
    }

    public remote function ShipOrder(ShipOrderRequest req, service msgListener, grpc:Headers? headers = ()) returns (grpc:Error?) {
        
        return self.grpcClient->nonBlockingExecute("hipstershop.ShippingService/ShipOrder", req, msgListener, headers);
    }

};


public type GetQuoteRequest record {|
    Address address;
    cartservice:CartItem[] items;
    
|};


public type GetQuoteResponse record {|
    currencyservice:Money cost_usd;
    
|};


public type ShipOrderRequest record {|
    Address address;
    cartservice:CartItem[] items;
    
|};


public type ShipOrderResponse record {|
    string tracking_id;
    
|};


public type Address record {|
    string street_address;
    string city;
    string state;
    string country;
    int zip_code;
    
|};

const string ROOT_DESCRIPTOR = "0A157368697070696E67736572766963652E70726F746F120B6869707374657273686F70226E0A0F47657451756F746552657175657374122E0A076164647265737318012001280B32142E6869707374657273686F702E41646472657373520761646472657373122B0A056974656D7318022003280B32152E6869707374657273686F702E436172744974656D52056974656D7322410A1047657451756F7465526573706F6E7365122D0A08636F73745F75736418012001280B32122E6869707374657273686F702E4D6F6E65795207636F7374557364226F0A10536869704F7264657252657175657374122E0A076164647265737318012001280B32142E6869707374657273686F702E41646472657373520761646472657373122B0A056974656D7318022003280B32152E6869707374657273686F702E436172744974656D52056974656D7322340A11536869704F72646572526573706F6E7365121F0A0B747261636B696E675F6964180120012809520A747261636B696E674964228F010A074164647265737312250A0E7374726565745F61646472657373180120012809520D7374726565744164647265737312120A046369747918022001280952046369747912140A0573746174651803200128095205737461746512180A07636F756E7472791804200128095207636F756E74727912190A087A69705F636F646518052001280552077A6970436F646522580A054D6F6E657912230A0D63757272656E63795F636F6465180120012809520C63757272656E6379436F646512140A05756E6974731802200128035205756E69747312140A056E616E6F7318032001280552056E616E6F7322450A08436172744974656D121D0A0A70726F647563745F6964180120012809520970726F647563744964121A0A087175616E7469747918022001280552087175616E7469747932AA010A0F5368697070696E675365727669636512490A0847657451756F7465121C2E6869707374657273686F702E47657451756F7465526571756573741A1D2E6869707374657273686F702E47657451756F7465526573706F6E73652200124C0A09536869704F72646572121D2E6869707374657273686F702E536869704F72646572526571756573741A1E2E6869707374657273686F702E536869704F72646572526573706F6E73652200620670726F746F33";
function getDescriptorMap() returns map<string> {
    return {
        "shippingservice.proto":"0A157368697070696E67736572766963652E70726F746F120B6869707374657273686F70226E0A0F47657451756F746552657175657374122E0A076164647265737318012001280B32142E6869707374657273686F702E41646472657373520761646472657373122B0A056974656D7318022003280B32152E6869707374657273686F702E436172744974656D52056974656D7322410A1047657451756F7465526573706F6E7365122D0A08636F73745F75736418012001280B32122E6869707374657273686F702E4D6F6E65795207636F7374557364226F0A10536869704F7264657252657175657374122E0A076164647265737318012001280B32142E6869707374657273686F702E41646472657373520761646472657373122B0A056974656D7318022003280B32152E6869707374657273686F702E436172744974656D52056974656D7322340A11536869704F72646572526573706F6E7365121F0A0B747261636B696E675F6964180120012809520A747261636B696E674964228F010A074164647265737312250A0E7374726565745F61646472657373180120012809520D7374726565744164647265737312120A046369747918022001280952046369747912140A0573746174651803200128095205737461746512180A07636F756E7472791804200128095207636F756E74727912190A087A69705F636F646518052001280552077A6970436F646522580A054D6F6E657912230A0D63757272656E63795F636F6465180120012809520C63757272656E6379436F646512140A05756E6974731802200128035205756E69747312140A056E616E6F7318032001280552056E616E6F7322450A08436172744974656D121D0A0A70726F647563745F6964180120012809520970726F647563744964121A0A087175616E7469747918022001280552087175616E7469747932AA010A0F5368697070696E675365727669636512490A0847657451756F7465121C2E6869707374657273686F702E47657451756F7465526571756573741A1D2E6869707374657273686F702E47657451756F7465526573706F6E73652200124C0A09536869704F72646572121D2E6869707374657273686F702E536869704F72646572526571756573741A1E2E6869707374657273686F702E536869704F72646572526573706F6E73652200620670726F746F33"
        
    };
}

